<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment - Academeo Portfolio</title>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <!-- Tailwind CSS & Font Awesome 6 -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
      .glass-effect {
        background: rgba(255,255,255,0.7);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255,255,255,0.2);
      }
      .gradient-text {
        background: linear-gradient(135deg, #6d28d9, #8b5cf6);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }
      .gradient-border {
        position: relative;
        border-radius: 0.75rem;
        background: linear-gradient(#f8f7ff, #f8f7ff) padding-box, linear-gradient(135deg, #6d28d9, #8b5cf6) border-box;
        border: 2px solid transparent;
      }
      .btn-hover-effect {
        transition: transform 0.15s, box-shadow 0.15s;
      }
      .btn-hover-effect:hover {
        transform: translateY(-2px) scale(1.03);
        box-shadow: 0 6px 24px 0 rgba(109,40,217,0.12);
      }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center bg-[#f8f7ff] py-8">
  <div class="glass-effect gradient-border rounded-2xl shadow-2xl w-full max-w-xl p-8 text-center">
    <h1 class="text-3xl font-bold gradient-text mb-6 flex items-center justify-center gap-2">
      <i class="fas fa-lock"></i> Unlock Your Portfolio
    </h1>
    {% if user_type == 'agent' %}
      <div class="inline-block px-4 py-1 rounded-full bg-cyan-600 text-white text-xs font-semibold mb-4">Agent Pricing</div>
    {% else %}
      <div class="inline-block px-4 py-1 rounded-full bg-gray-700 text-white text-xs font-semibold mb-4">Student Pricing</div>
    {% endif %}
    <div class="bg-violet-50 rounded-xl p-6 mb-6">
      <div class="text-lg text-gray-400 line-through">₹2,999</div>
      <div class="text-3xl font-bold text-green-600 my-2">₹{{ amount|floatformat:0 }}</div>
      {% if user_type == 'agent' %}
        <p class="text-sm text-cyan-700">Special Agent Rate - Pay in bulk for multiple students</p>
      {% else %}
        <p class="text-sm text-green-700">Limited Time Offer - Save ₹1,500!</p>
      {% endif %}
    </div>
    <div class="text-left mb-6">
      <h3 class="text-lg font-semibold mb-2">What You Get:</h3>
      <ul class="space-y-2">
        <li class="flex items-center gap-2"><span class="text-green-500"><i class="fas fa-check-circle"></i></span> Professional Portfolio Website</li>
        <!-- <li class="flex items-center gap-2"><span class="text-green-500"><i class="fas fa-check-circle"></i></span> PDF Resume Generation</li> -->
        <li class="flex items-center gap-2"><span class="text-green-500"><i class="fas fa-check-circle"></i></span> Unlimited Template Changes</li>
        <li class="flex items-center gap-2"><span class="text-green-500"><i class="fas fa-check-circle"></i></span> Custom Domain Support</li>
        <li class="flex items-center gap-2"><span class="text-green-500"><i class="fas fa-check-circle"></i></span> Email Support</li>
        {% if user_type == 'agent' %}
        <li class="flex items-center gap-2"><span class="text-green-500"><i class="fas fa-check-circle"></i></span> Bulk Student Management</li>
        <li class="flex items-center gap-2"><span class="text-green-500"><i class="fas fa-check-circle"></i></span> Referral Tracking Dashboard</li>
        {% endif %}
      </ul>
    </div>
    <!-- Coupon code form -->
    <form method="post" class="flex flex-col md:flex-row items-center justify-center gap-2 mb-6">
      {% csrf_token %}
      <input type="text" name="coupon_code" placeholder="Enter coupon code"
        class="px-4 py-2 rounded-lg border border-gray-300 focus:border-violet-500 focus:ring-2 focus:ring-violet-200 w-48">
      <button type="submit"
        class="btn-hover-effect bg-green-500 text-white px-5 py-2 rounded-lg font-semibold flex items-center gap-2 shadow">
        <i class="fas fa-tag"></i> Apply Coupon
      </button>
    </form>
    <button id="rzp-button" class="btn-hover-effect bg-gradient-to-r from-violet-600 to-indigo-500 text-white px-8 py-3 rounded-xl font-semibold text-lg flex items-center justify-center gap-2 shadow w-full mb-4">
      <i class="fas fa-credit-card"></i> Pay ₹{{ amount|floatformat:0 }} Now
    </button>
    <form id="payment-form" method="post" action="{% url 'payment_success' %}" style="display:none;">
      {% csrf_token %}
      <input type="hidden" name="razorpay_order_id" id="razorpay_order_id">
      <input type="hidden" name="razorpay_payment_id" id="razorpay_payment_id">
      <input type="hidden" name="razorpay_signature" id="razorpay_signature">
    </form>
    <p class="text-xs text-gray-500 mt-2 flex items-center justify-center gap-2"><i class="fas fa-shield-alt"></i> Secure payment powered by Razorpay</p>
  </div>
  <script>
    var options = {
      "key": "{{ api_key }}",
      "amount": "{{ amount_paise }}",
      "currency": "INR",
      "name": "Academeo",
      "description": "Portfolio Access Purchase",
      "order_id": "{{ order_id }}",
      "handler": function (response) {
        document.getElementById('razorpay_order_id').value = response.razorpay_order_id;
        document.getElementById('razorpay_payment_id').value = response.razorpay_payment_id;
        document.getElementById('razorpay_signature').value = response.razorpay_signature;
        document.getElementById('payment-form').submit();
      },
      "prefill": {
        "name": "{{ user.first_name }} {{ user.last_name }}",
        "email": "{{ user.email }}"
      },
      "theme": {
        "color": "#3399cc"
      }
    };
    var rzp = new Razorpay(options);
    document.getElementById('rzp-button').onclick = function (e) {
      rzp.open();
      e.preventDefault();
    }
  </script>
</body>
</html>